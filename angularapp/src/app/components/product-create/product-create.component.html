<div class="container-flux">
    <div class="container">
        <form #productForm="ngForm" (ngSubmit)="addProduct()" *ngIf="!isEditMode"> 
            <div *ngIf="isFormInvalid" style="color: red; text-align: center;">
                <span>All fields are required. Please fill out the missing details.</span>
            </div>
        <div class="icontainer">
            <h1 style="text-align: center;">Create New Product</h1>
            <label for="productName">Product Name</label>
            <input type="text" [(ngModel)]="product.productName" required name="productName" #productName="ngModel">
            <div *ngIf="productName.touched && productName.invalid">
                <span style="color: red;">Product Name is required</span>
            </div>
        </div>
        <div>
            <label for="description">Description</label>
            <input type="text" [(ngModel)]="product.description" required name="description" #description="ngModel">
            <div *ngIf="description.touched && description.invalid">
                <span style="color: red;">Description is required</span>
            </div>
        </div>
        <div>
            <label for="price">Price</label>
            <input type="number" [(ngModel)]="product.price" required name="price" #price="ngModel" min="0" step="0.01">
            <div *ngIf="price.touched && price.invalid || product.price < 0">
                <span style="color: red;">Valid non-negative price is required</span>
            </div>
        </div>
        <div>
            <label for="stockQuantity">Stock Quantity</label>
            <input type="number" [(ngModel)]="product.stockQuantity" required name="stockQuantity" #stockQuantity="ngModel" min="0">
            <div *ngIf="stockQuantity.touched && stockQuantity.invalid">
                <span style="color: red;">Valid stock quantity is required</span>
            </div>
        </div>
        <div>
            <label for="category">Category</label>
            <select name="category" id="category" required [(ngModel)]="product.category" #category="ngModel">
                <option value="" disabled>Select Category</option>
                <option value="electronics">Electronics</option>
                <option value="homeAppliances">Home Appliances</option>
                <option value="books">Books</option>
                <option value="fashion">Fashion</option>
                <option value="toys">Toys</option>
                <option value="furniture">Furniture</option>
                <option value="beauty">Beauty</option>
            </select>
            <div *ngIf="category.touched && category.invalid">
                <span style="color: red;">Category is required</span>
            </div>
        </div>
        <div>
            <label for="brand">Brand</label>
            <input type="text" [(ngModel)]="product.brand" required name="brand" #brand="ngModel">
            <div *ngIf="brand.touched && brand.invalid">
                <span style="color: red;">Brand is required</span>
            </div>
        </div>
        <div>
            <div class="form-group">
                <label for="coverImage">Cover Image</label>
                <input type="file" ngModel (change)="handleFileChange($event)" required name="coverImage" #coverImage="ngModel" class="form-control">
                <div *ngIf="!product.coverImage && productForm.submitted" class="error">Cover Image is required</div>
              </div>
              
              <div *ngIf="product.coverImage" style="margin-top: 10px;">
                <img [src]="product.coverImage" alt="Product Preview" style="max-width: 200px;">
              </div>
              
        </div>
        <button type="submit" [disabled]="productForm.invalid">Add Product</button>
    </form>
    
    </div>
</div>


<div class="container" *ngIf="isEditMode">
    <button [routerLink]="['/admin-view-product']" >Back</button>
    <h2>Edit Product</h2>
    <form #productForm="ngForm" (ngSubmit)="updateProduct()"> 
    <div>
        <label for="productName">Product Name</label>
        <input type="text" [(ngModel)]="product.productName" required name="productName" #productName="ngModel">
        <div *ngIf="productName.touched && productName.invalid">
            <span style="color: red;">Product Name is required</span>
        </div>
    </div>
    <div>
        <label for="description">Description</label>
        <input type="text" [(ngModel)]="product.description" required name="description" #description="ngModel">
        <div *ngIf="description.touched && description.invalid">
            <span style="color: red;">Description is required</span>
        </div>
    </div>
    <div>
        <label for="price">Price</label>
        <input type="number" [(ngModel)]="product.price" required name="price" #price="ngModel" min="0" step="0.01">
        <div *ngIf="price.touched && price.invalid || product.price < 0">
            <span style="color: red;">Valid non-negative price is required</span>
        </div>
    </div>
    <div>
        <label for="stockQuantity">Stock Quantity</label>
        <input type="number" [(ngModel)]="product.stockQuantity" required name="stockQuantity" #stockQuantity="ngModel" min="0">
        <div *ngIf="stockQuantity.touched && stockQuantity.invalid">
            <span style="color: red;">Valid stock quantity is required</span>
        </div>
    </div>
    <div>
        <label for="category">Category</label>
        <select name="category" id="category" required [(ngModel)]="product.category" #category="ngModel">
            <option value="" disabled>Select Category</option>
            <option value="electronics">Electronics</option>
            <option value="homeAppliances">Home Appliances</option>
            <option value="books">Books</option>
            <option value="fashion">Fashion</option>
            <option value="toys">Toys</option>
            <option value="furniture">Furniture</option>
            <option value="beauty">Beauty</option>
        </select>
        <div *ngIf="category.touched && category.invalid">
            <span style="color: red;">Category is required</span>
        </div>
    </div>
    <div>
        <label for="brand">Brand</label>
        <input type="text" [(ngModel)]="product.brand" required name="brand" #brand="ngModel">
        <div *ngIf="brand.touched && brand.invalid">
            <span style="color: red;">Brand is required</span>
        </div>
    </div>
    <div>
        <label for="coverImage">Cover Image</label>
        <input type="file" [(ngModel)]="product.coverImage" required name="coverImage" #coverImage="ngModel">
        <div *ngIf="coverImage.touched && coverImage.invalid">
            <span style="color: red;">Cover Image is required</span>
        </div>
    </div>
    <button type="submit">Update Product</button>
    </form>
</div>
