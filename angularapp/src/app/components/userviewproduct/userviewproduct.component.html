<div>
    <h1>Products</h1>


    <div class="controls">
        <input type="text" placeholder="Search by product name" [(ngModel)]="searchData" (input)="searchProducts()">
        <select [(ngModel)]="selectedCategory" (change)="searchProducts()">
            <option value="">All Categories</option>
            <option value="electronics">Electronics</option>
            <option value="homeAppliances">Home Appliances</option>
            <option value="books">Books</option>
            <option value="fashion">Fashion</option>
            <option value="toys">Toys</option>
            <option value="furniture">Furniture</option>
            <option value="beauty">Beauty</option>
        </select>
    </div>

    <div class="container">
        <ul *ngIf="filteredProducts">
            <li *ngFor="let product of filteredProducts">
                <p>{{ product.productName }}</p>
                <p>Price: {{ product.price }}</p>
                <p>{{ product.description }}</p>
                <p>In stock: {{ product.stockQuantity }}</p>
                <p>Category: {{ product.category }}</p>
                <p>Brand: {{ product.brand }}</p>

                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" [(ngModel)]="product.selectedQuantity" 
                       (change)="validateQuantity(product)" 
                       [placeholder]="'Enter up to ' + product.stockQuantity" 
                       min="1">

                <button (click)= "viewReview(product.productId)">View Reviews</button><br>
                <button [routerLink]="['/review',product.productId]">Write a Review</button><br>
            </li>
        </ul>
    </div>

    <div *ngIf="!products.length">
        <p>No Products Found</p>
    </div>
</div>

<div class="popup" *ngIf="popupVisible">
    
    <div *ngIf="reviews && reviews.length > 0">
      <h2>Reviews</h2>
      <ul>
        <li *ngFor="let review of reviews">
          <span>Rating: {{ review.rating }}/5</span>
          <span>{{ review.reviewText }}</span>
          <span>Date: {{ review.date | date:'mediumDate' }}</span>
        </li>
      </ul>
    </div>
    
    <div *ngIf="!reviews || reviews.length === 0">
      <span>No review found for this product.</span>
    </div>
    <button (click)="closePopup()">Close</button>
  </div>
  


